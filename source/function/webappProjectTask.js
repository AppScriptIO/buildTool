"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports, "__esModule", { value: true });exports.serverSide_transpileServerSide = exports.serverSide_transpileDatabaseData = exports.serverSide_copyDatabaseData = exports.serverSide_copyServerSide = exports.serverSide_installPackageUsingYarn = exports.polyfillClientSide_javascript = exports.polyfillClientSide_stylesheet = exports.polyfillClientSide_html = exports.polyfillClientSide_json = exports.polyfillClientSide_copySourceCode = exports.nativeClientSide_javascript = exports.nativeClientSide_stylesheet = exports.nativeClientSide_html = exports.nativeClientSide_json = exports.nativeClientSide_copySourceCode = exports.clientSide_libraryYarn = exports.clientSide_webcomponentYarn = exports.clientSide_jspm = void 0;var _path = _interopRequireDefault(require("path"));


var _util = _interopRequireDefault(require("util"));
var _stream = _interopRequireDefault(require("stream"));



var _vinylFs = require("vinyl-fs");
var _glob = _interopRequireDefault(require("glob"));

var _deploymentProvisioning = require("@dependency/deploymentProvisioning");



var _html = require("../transformPipeline/html.js");

var _javascript = require("../transformPipeline/javascript.js");
var _json = require("../transformPipeline/json.js");
var _stylesheet = require("../transformPipeline/stylesheet.js");
var _convertArrayToMultiplePatternGlob = require("../utility/convertArrayToMultiplePatternGlob.js");const pipeline = _util.default.promisify(_stream.default.pipeline);const wildcardPathnameMatcher = _util.default.promisify(_glob.default);
const packageDependencyPatternMatch = '**/@package*/**/*',
nodeModulePatternMatch = '**/node_modules/**/*';












const clientSide_jspm = ({ node, context }) => {
  let targetProjectConfig = context.targetProjectConfig || function (e) {throw e;}(new Error(`• Context "targetProjectConfig" variable is required to run project dependent tasks.`));
  (0, _deploymentProvisioning.installPackageUsingJspm)({ jspmPath: _path.default.join(targetProjectConfig.directory.source, '/packageManager/library.browser.jspm') });
};exports.clientSide_jspm = clientSide_jspm;

const clientSide_webcomponentYarn = ({ node, context }) => {
  let targetProjectConfig = context.targetProjectConfig || function (e) {throw e;}(new Error(`• Context "targetProjectConfig" variable is required to run project dependent tasks.`));
  (0, _deploymentProvisioning.installPackageUsingYarn)({ yarnPath: _path.default.join(targetProjectConfig.directory.source, '/packageManager/webcomponent.browser.yarn/') });
};exports.clientSide_webcomponentYarn = clientSide_webcomponentYarn;

const clientSide_libraryYarn = ({ node, context }) => {
  let targetProjectConfig = context.targetProjectConfig || function (e) {throw e;}(new Error(`• Context "targetProjectConfig" variable is required to run project dependent tasks.`));
  (0, _deploymentProvisioning.installPackageUsingYarn)({ yarnPath: _path.default.join(targetProjectConfig.directory.source, '/packageManager/library.browser.yarn/') });
};exports.clientSide_libraryYarn = clientSide_libraryYarn;








const nativeClientSide_copySourceCode = async ({ node, context }) => {
  let targetProjectConfig = context.targetProjectConfig || function (e) {throw e;}(new Error(`• Context "targetProjectConfig" variable is required to run project dependent tasks.`));
  await _deploymentProvisioning.synchronizeFile.recursivelySyncFile({
    source: targetProjectConfig.directory.clientSide,
    destination: targetProjectConfig.distribution.clientSide.native,
    copyContentOnly: true });

};exports.nativeClientSide_copySourceCode = nativeClientSide_copySourceCode;

const nativeClientSide_json = async ({ node, context }) => {
  let targetProjectConfig = context.targetProjectConfig || function (e) {throw e;}(new Error(`• Context "targetProjectConfig" variable is required to run project dependent tasks.`));
  let basePath = targetProjectConfig.directory.clientSide;
  let fileArray = await wildcardPathnameMatcher('**/*.json', { cwd: basePath, absolute: true, ignore: packageDependencyPatternMatch });
  if (fileArray.length) await pipeline((0, _vinylFs.src)(fileArray, { base: basePath }), ...(0, _json.pipeline)(), (0, _vinylFs.dest)(targetProjectConfig.distribution.clientSide.native));
};exports.nativeClientSide_json = nativeClientSide_json;

const nativeClientSide_html = async ({ node, context }) => {
  let targetProjectConfig = context.targetProjectConfig || function (e) {throw e;}(new Error(`• Context "targetProjectConfig" variable is required to run project dependent tasks.`));
  let basePath = targetProjectConfig.directory.clientSide;
  let fileArray = await wildcardPathnameMatcher('**/*.html', { cwd: basePath, absolute: true, ignore: packageDependencyPatternMatch });
  if (fileArray.length)
  await pipeline(
  (0, _vinylFs.src)(fileArray, { base: basePath }),
  ...(0, _html.pipeline)({ babelConfigFileName: 'nativeClientSideBuild.BabelConfig.js' }),
  (0, _vinylFs.dest)(targetProjectConfig.distribution.clientSide.native));

};exports.nativeClientSide_html = nativeClientSide_html;

const nativeClientSide_stylesheet = async ({ node, context }) => {
  let targetProjectConfig = context.targetProjectConfig || function (e) {throw e;}(new Error(`• Context "targetProjectConfig" variable is required to run project dependent tasks.`));
  let basePath = targetProjectConfig.directory.clientSide;
  let fileArray = await wildcardPathnameMatcher('**/*.css', { cwd: basePath, absolute: true, ignore: packageDependencyPatternMatch });
  if (fileArray.length) await pipeline((0, _vinylFs.src)(fileArray, { base: basePath }), ...(0, _stylesheet.pipeline)(), (0, _vinylFs.dest)(targetProjectConfig.distribution.clientSide.native));
};exports.nativeClientSide_stylesheet = nativeClientSide_stylesheet;

const nativeClientSide_javascript = async ({ node, context }) => {var _ref;
  let targetProjectConfig = context.targetProjectConfig || function (e) {throw e;}(new Error(`• Context "targetProjectConfig" variable is required to run project dependent tasks.`));
  let basePath = targetProjectConfig.directory.clientSide;
  let fileArray = await wildcardPathnameMatcher((_ref =
  [
  '**/*.js'], (0,


  _convertArrayToMultiplePatternGlob.convertArrayToMultiplePatternGlob)(_ref)),
  {
    cwd: basePath,
    absolute: true,
    ignore: [
    packageDependencyPatternMatch] });




  if (fileArray.length)
  await pipeline(
  (0, _vinylFs.src)(fileArray, { base: basePath }),
  ...(0, _javascript.serverJSPipeline)({ babelConfigFileName: 'nativeClientSideBuild.BabelConfig.js', includeSourceMap: false }),
  (0, _vinylFs.dest)(targetProjectConfig.distribution.clientSide.native));

};exports.nativeClientSide_javascript = nativeClientSide_javascript;









const polyfillClientSide_copySourceCode = ({ node, context }) => {
  let targetProjectConfig = context.targetProjectConfig || function (e) {throw e;}(new Error(`• Context "targetProjectConfig" variable is required to run project dependent tasks.`));
  _deploymentProvisioning.synchronizeFile.recursivelySyncFile({ source: targetProjectConfig.directory.clientSide, destination: targetProjectConfig.distribution.clientSide.polyfill, copyContentOnly: true });
};exports.polyfillClientSide_copySourceCode = polyfillClientSide_copySourceCode;

const polyfillClientSide_json = async ({ node, context }) => {
  let targetProjectConfig = context.targetProjectConfig || function (e) {throw e;}(new Error(`• Context "targetProjectConfig" variable is required to run project dependent tasks.`));
  let basePath = targetProjectConfig.directory.clientSide;
  let fileArray = await wildcardPathnameMatcher('**/*.json', { cwd: basePath, absolute: true, ignore: packageDependencyPatternMatch });
  if (fileArray.length) await pipeline((0, _vinylFs.src)(fileArray, { base: basePath }), ...(0, _json.pipeline)(), (0, _vinylFs.dest)(targetProjectConfig.distribution.clientSide.polyfill));
};exports.polyfillClientSide_json = polyfillClientSide_json;

const polyfillClientSide_html = async ({ node, context }) => {
  let targetProjectConfig = context.targetProjectConfig || function (e) {throw e;}(new Error(`• Context "targetProjectConfig" variable is required to run project dependent tasks.`));
  let basePath = targetProjectConfig.directory.clientSide;
  let fileArray = await wildcardPathnameMatcher('**/*.html', { cwd: basePath, absolute: true, ignore: packageDependencyPatternMatch });
  if (fileArray.length)
  await pipeline(
  (0, _vinylFs.src)(fileArray, { base: basePath }),
  ...(0, _html.pipeline)({ babelConfigFileName: 'polyfillClientSideBuild.BabelConfig.js' }),
  (0, _vinylFs.dest)(targetProjectConfig.distribution.clientSide.polyfill));

};exports.polyfillClientSide_html = polyfillClientSide_html;

const polyfillClientSide_stylesheet = async ({ node, context }) => {
  let targetProjectConfig = context.targetProjectConfig || function (e) {throw e;}(new Error(`• Context "targetProjectConfig" variable is required to run project dependent tasks.`));
  let basePath = targetProjectConfig.directory.clientSide;
  let fileArray = await wildcardPathnameMatcher('**/*.css', { cwd: basePath, absolute: true, ignore: packageDependencyPatternMatch });
  if (fileArray.length) await pipeline((0, _vinylFs.src)(fileArray, { base: basePath }), ...(0, _stylesheet.pipeline)(), (0, _vinylFs.dest)(targetProjectConfig.distribution.clientSide.polyfill));
};exports.polyfillClientSide_stylesheet = polyfillClientSide_stylesheet;

const polyfillClientSide_javascript = async ({ node, context }) => {var _ref2;
  let targetProjectConfig = context.targetProjectConfig || function (e) {throw e;}(new Error(`• Context "targetProjectConfig" variable is required to run project dependent tasks.`));
  let basePath = targetProjectConfig.directory.clientSide;
  let fileArray = await wildcardPathnameMatcher((_ref2 =
  [
  '**/*.js'], (0,


  _convertArrayToMultiplePatternGlob.convertArrayToMultiplePatternGlob)(_ref2)),
  {
    cwd: basePath,
    absolute: true,
    ignore: [
    packageDependencyPatternMatch] });




  if (fileArray.length)
  await pipeline(
  (0, _vinylFs.src)(fileArray, { base: basePath }),
  ...(0, _javascript.serverJSPipeline)({ babelConfigFileName: 'polyfillClientSideBuild.BabelConfig.js', includeSourceMap: false }),
  (0, _vinylFs.dest)(targetProjectConfig.distribution.clientSide.polyfill));

};exports.polyfillClientSide_javascript = polyfillClientSide_javascript;








const serverSide_installPackageUsingYarn = ({ node, context }) => {
  let targetProjectConfig = context.targetProjectConfig || function (e) {throw e;}(new Error(`• Context "targetProjectConfig" variable is required to run project dependent tasks.`));
  (0, _deploymentProvisioning.installPackageUsingYarn)({ yarnPath: _path.default.join(targetProjectConfig.directory.source, '/packageManager/library.server.yarn/') });
};exports.serverSide_installPackageUsingYarn = serverSide_installPackageUsingYarn;

const serverSide_copyServerSide = async ({ node, context }) => {
  let targetProjectConfig = context.targetProjectConfig || function (e) {throw e;}(new Error(`• Context "targetProjectConfig" variable is required to run project dependent tasks.`));
  await _deploymentProvisioning.synchronizeFile.recursivelySyncFile({ source: targetProjectConfig.directory.serverSide, destination: targetProjectConfig.distribution.serverSide, copyContentOnly: true });
};exports.serverSide_copyServerSide = serverSide_copyServerSide;

const serverSide_copyDatabaseData = async ({ node, context }) => {
  let targetProjectConfig = context.targetProjectConfig || function (e) {throw e;}(new Error(`• Context "targetProjectConfig" variable is required to run project dependent tasks.`));
  await _deploymentProvisioning.synchronizeFile.recursivelySyncFile.recursivelySyncFile({
    source: _path.default.join(targetProjectConfig.directory.source, 'databaseData'),
    destination: targetProjectConfig.directory.distribution,
    copyContentOnly: false });

};exports.serverSide_copyDatabaseData = serverSide_copyDatabaseData;

const serverSide_transpileDatabaseData = async ({ node, context }) => {
  let targetProjectConfig = context.targetProjectConfig || function (e) {throw e;}(new Error(`• Context "targetProjectConfig" variable is required to run project dependent tasks.`));
  let basePath = targetProjectConfig.directory.source;
  let fileArray = await wildcardPathnameMatcher('databaseData/**/*.js', { cwd: basePath, absolute: true, ignore: nodeModulePatternMatch });
  if (fileArray.length)
  await pipeline(
  (0, _vinylFs.src)(fileArray, { base: basePath }),
  ...(0, _javascript.serverJSPipeline)({ babelConfigFileName: 'serverBuild.BabelConfig.js', includeSourceMap: false }),
  (0, _vinylFs.dest)(_path.default.join(targetProjectConfig.directory.distribution, 'databaseData/')));

};exports.serverSide_transpileDatabaseData = serverSide_transpileDatabaseData;

const serverSide_transpileServerSide = async ({ node, context }) => {
  let targetProjectConfig = context.targetProjectConfig || function (e) {throw e;}(new Error(`• Context "targetProjectConfig" variable is required to run project dependent tasks.`));
  let basePath = targetProjectConfig.directory.serverSide;
  let fileArray = await wildcardPathnameMatcher('**/*.js', { cwd: basePath, absolute: true, ignore: nodeModulePatternMatch });
  if (fileArray.length)
  await pipeline(
  (0, _vinylFs.src)(fileArray, { base: basePath }),
  ...(0, _javascript.serverJSPipeline)({ babelConfigFileName: 'serverBuild.BabelConfig.js', includeSourceMap: false }),
  (0, _vinylFs.dest)(targetProjectConfig.distribution.serverSide));

};exports.serverSide_transpileServerSide = serverSide_transpileServerSide;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NvdXJjZS9mdW5jdGlvbi93ZWJhcHBQcm9qZWN0VGFzay5qcyJdLCJuYW1lcyI6WyJwaXBlbGluZSIsInV0aWwiLCJwcm9taXNpZnkiLCJzdHJlYW0iLCJ3aWxkY2FyZFBhdGhuYW1lTWF0Y2hlciIsIm9yaWdpbmFsX3dpbGRjYXJkUGF0aG5hbWVNYXRjaGVyIiwicGFja2FnZURlcGVuZGVuY3lQYXR0ZXJuTWF0Y2giLCJub2RlTW9kdWxlUGF0dGVybk1hdGNoIiwiY2xpZW50U2lkZV9qc3BtIiwibm9kZSIsImNvbnRleHQiLCJ0YXJnZXRQcm9qZWN0Q29uZmlnIiwiRXJyb3IiLCJqc3BtUGF0aCIsInBhdGgiLCJqb2luIiwiZGlyZWN0b3J5Iiwic291cmNlIiwiY2xpZW50U2lkZV93ZWJjb21wb25lbnRZYXJuIiwieWFyblBhdGgiLCJjbGllbnRTaWRlX2xpYnJhcnlZYXJuIiwibmF0aXZlQ2xpZW50U2lkZV9jb3B5U291cmNlQ29kZSIsInN5bmNocm9uaXplRmlsZSIsInJlY3Vyc2l2ZWx5U3luY0ZpbGUiLCJjbGllbnRTaWRlIiwiZGVzdGluYXRpb24iLCJkaXN0cmlidXRpb24iLCJuYXRpdmUiLCJjb3B5Q29udGVudE9ubHkiLCJuYXRpdmVDbGllbnRTaWRlX2pzb24iLCJiYXNlUGF0aCIsImZpbGVBcnJheSIsImN3ZCIsImFic29sdXRlIiwiaWdub3JlIiwibGVuZ3RoIiwiYmFzZSIsIm5hdGl2ZUNsaWVudFNpZGVfaHRtbCIsImJhYmVsQ29uZmlnRmlsZU5hbWUiLCJuYXRpdmVDbGllbnRTaWRlX3N0eWxlc2hlZXQiLCJuYXRpdmVDbGllbnRTaWRlX2phdmFzY3JpcHQiLCJjb252ZXJ0QXJyYXlUb011bHRpcGxlUGF0dGVybkdsb2IiLCJpbmNsdWRlU291cmNlTWFwIiwicG9seWZpbGxDbGllbnRTaWRlX2NvcHlTb3VyY2VDb2RlIiwicG9seWZpbGwiLCJwb2x5ZmlsbENsaWVudFNpZGVfanNvbiIsInBvbHlmaWxsQ2xpZW50U2lkZV9odG1sIiwicG9seWZpbGxDbGllbnRTaWRlX3N0eWxlc2hlZXQiLCJwb2x5ZmlsbENsaWVudFNpZGVfamF2YXNjcmlwdCIsInNlcnZlclNpZGVfaW5zdGFsbFBhY2thZ2VVc2luZ1lhcm4iLCJzZXJ2ZXJTaWRlX2NvcHlTZXJ2ZXJTaWRlIiwic2VydmVyU2lkZSIsInNlcnZlclNpZGVfY29weURhdGFiYXNlRGF0YSIsInNlcnZlclNpZGVfdHJhbnNwaWxlRGF0YWJhc2VEYXRhIiwic2VydmVyU2lkZV90cmFuc3BpbGVTZXJ2ZXJTaWRlIl0sIm1hcHBpbmdzIjoieTBCQUFBOzs7QUFHQTtBQUNBOzs7O0FBSUE7QUFDQTs7QUFFQTs7OztBQUlBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLG9HQWZBLE1BQU1BLFFBQVEsR0FBR0MsY0FBS0MsU0FBTCxDQUFlQyxnQkFBT0gsUUFBdEIsQ0FBakIsQ0FLQSxNQUFNSSx1QkFBdUIsR0FBR0gsY0FBS0MsU0FBTCxDQUFlRyxhQUFmLENBQWhDO0FBV0EsTUFBTUMsNkJBQTZCLEdBQUcsbUJBQXRDO0FBQ0VDLHNCQUFzQixHQUFHLHNCQUQzQjs7Ozs7Ozs7Ozs7OztBQWNPLE1BQU1DLGVBQWUsR0FBRyxDQUFDLEVBQUVDLElBQUYsRUFBUUMsT0FBUixFQUFELEtBQXVCO0FBQ3BELE1BQUlDLG1CQUFtQixHQUFHRCxPQUFPLENBQUNDLG1CQUFSLDRCQUFxQyxJQUFJQyxLQUFKLENBQVcsc0ZBQVgsQ0FBckMsQ0FBMUI7QUFDQSx1REFBd0IsRUFBRUMsUUFBUSxFQUFFQyxjQUFLQyxJQUFMLENBQVVKLG1CQUFtQixDQUFDSyxTQUFwQixDQUE4QkMsTUFBeEMsRUFBZ0Qsc0NBQWhELENBQVosRUFBeEI7QUFDRCxDQUhNLEM7O0FBS0EsTUFBTUMsMkJBQTJCLEdBQUcsQ0FBQyxFQUFFVCxJQUFGLEVBQVFDLE9BQVIsRUFBRCxLQUF1QjtBQUNoRSxNQUFJQyxtQkFBbUIsR0FBR0QsT0FBTyxDQUFDQyxtQkFBUiw0QkFBcUMsSUFBSUMsS0FBSixDQUFXLHNGQUFYLENBQXJD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QXFESSxnQkFBZ0IsRUFBRSxLQUF2RSxFQUFqQixDQUZTO0FBR1oscUJBQTBCNUIsY0FBS0MsSUFBTCxDQUFVSixtQkFBbUIsQ0FBQ0ssU0FBcEIsQ0FBOEJVLFlBQXhDLEVBQXNELGVBQXRELENBQTFCLENBSFksQ0FBZDs7QUFLSCxDQVZNLEM7O0FBWUEsTUFBTTRCLDhCQUE4QixHQUFHLE9BQU8sRUFBRTdDLElBQUYsRUFBUUMsT0FBUixFQUFQLEtBQTZCO0FBQ3pFLE1BQUlDLG1CQUFtQixHQUFHRCxPQUFPLENBQUNDLG1CQUFSLDRCQUFxQyxJQUFJQyxLQUFKLENBQVcsc0ZBQVgsQ0FBckMsQ0FBMUI7QUFDQSxNQUFJa0IsUUFBUSxHQUFHbkIsbUJBQW1CLENBQUNLLFNBQXBCLENBQThCbUMsVUFBN0M7QUFDQSxNQUFJcEIsU0FBUyxHQUFHLE1BQU0zQix1QkFBdUIsQ0FBQyxTQUFELEVBQVksRUFBRTRCLEdBQUcsRUFBRUYsUUFBUCxFQUFpQkcsUUFBUSxFQUFFLElBQTNCLEVBQW1FQyxNQUFNLEVBQUUzQixzQkFBM0UsRUFBWixDQUE3QztBQUNBLE1BQUl3QixTQUFTLENBQUNJLE1BQWQ7QUFDRSxRQUFNbkMsUUFBUTtBQUNaLG9CQUF1QitCLFNBQXZCLEVBQWtDLEVBQUVLLElBQUksRUFBRU4sUUFBUixFQUFsQyxDQURZO0FBRVosS0FBRyxrQ0FBaUIsRUFBRVEsbUJBQW1CLEVBQUUsNEJBQXZCLEVBQXFESSxnQkFBZ0IsRUFBRSxLQUF2RSxFQUFqQixDQUZTO0FBR1oscUJBQTBCL0IsbUJBQW1CLENBQUNlLFlBQXBCLENBQWlDeUIsVUFBM0QsQ0FIWSxDQUFkOztBQUtILENBVk0sQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgZmlsZXN5c3RlbSBmcm9tICdmcydcbmltcG9ydCBhc3NlcnQgZnJvbSAnYXNzZXJ0J1xuaW1wb3J0IHV0aWwgZnJvbSAndXRpbCdcbmltcG9ydCBzdHJlYW0gZnJvbSAnc3RyZWFtJ1xuY29uc3QgcGlwZWxpbmUgPSB1dGlsLnByb21pc2lmeShzdHJlYW0ucGlwZWxpbmUpXG5pbXBvcnQgbWVyZ2VTdHJlYW0gZnJvbSAnbWVyZ2Utc3RyZWFtJ1xuLy8gaHR0cHM6Ly9naXRodWIuY29tL2d1bHBqcy92aW55bC1mcyNkZXN0Zm9sZGVyLW9wdGlvbnMgJiBodHRwczovL2d1bHBqcy5jb20vZG9jcy9lbi9hcGkvc3JjXG5pbXBvcnQgeyBzcmMgYXMgcmVhZEZpbGVBc09iamVjdFN0cmVhbSwgZGVzdCBhcyB3cml0ZUZpbGVGcm9tT2JqZWN0U3RyZWFtIH0gZnJvbSAndmlueWwtZnMnXG5pbXBvcnQgb3JpZ2luYWxfd2lsZGNhcmRQYXRobmFtZU1hdGNoZXIgZnJvbSAnZ2xvYicgLy8gQWx0ZXJuYXRpdmUgbW9kdWxlcyAtIGBnbG9iYnlgLCBgZ2xvYmAsIGBnbG9iLXN0cmVhbWBcbmNvbnN0IHdpbGRjYXJkUGF0aG5hbWVNYXRjaGVyID0gdXRpbC5wcm9taXNpZnkob3JpZ2luYWxfd2lsZGNhcmRQYXRobmFtZU1hdGNoZXIpXG5pbXBvcnQgeyBpbnN0YWxsUGFja2FnZVVzaW5nSnNwbSB9IGZyb20gJ0BkZXBlbmRlbmN5L2RlcGxveW1lbnRQcm92aXNpb25pbmcnXG5pbXBvcnQgeyBpbnN0YWxsUGFja2FnZVVzaW5nWWFybiB9IGZyb20gJ0BkZXBlbmRlbmN5L2RlcGxveW1lbnRQcm92aXNpb25pbmcnXG5pbXBvcnQgeyBpbnN0YWxsUGFja2FnZVVzaW5nTnBtIH0gZnJvbSAnQGRlcGVuZGVuY3kvZGVwbG95bWVudFByb3Zpc2lvbmluZydcbmltcG9ydCB7IHN5bmNocm9uaXplRmlsZSB9IGZyb20gJ0BkZXBlbmRlbmN5L2RlcGxveW1lbnRQcm92aXNpb25pbmcnXG5pbXBvcnQgeyBwaXBlbGluZSBhcyBodG1sUGlwZWxpbmUgfSBmcm9tICcuLi90cmFuc2Zvcm1QaXBlbGluZS9odG1sLmpzJ1xuaW1wb3J0IHsgcGlwZWxpbmUgYXMgaW1hZ2VQaXBlbGluZSB9IGZyb20gJy4uL3RyYW5zZm9ybVBpcGVsaW5lL2ltYWdlLmpzJ1xuaW1wb3J0IHsgY2xpZW50SlNQaXBlbGluZSwgc2VydmVySlNQaXBlbGluZSB9IGZyb20gJy4uL3RyYW5zZm9ybVBpcGVsaW5lL2phdmFzY3JpcHQuanMnXG5pbXBvcnQgeyBwaXBlbGluZSBhcyBqc29uUGlwZWxpbmUgfSBmcm9tICcuLi90cmFuc2Zvcm1QaXBlbGluZS9qc29uLmpzJ1xuaW1wb3J0IHsgcGlwZWxpbmUgYXMgc3R5bGVzaGVldFBpcGVsaW5lIH0gZnJvbSAnLi4vdHJhbnNmb3JtUGlwZWxpbmUvc3R5bGVzaGVldC5qcydcbmltcG9ydCB7IGNvbnZlcnRBcnJheVRvTXVsdGlwbGVQYXR0ZXJuR2xvYiB9IGZyb20gJy4uL3V0aWxpdHkvY29udmVydEFycmF5VG9NdWx0aXBsZVBhdHRlcm5HbG9iLmpzJ1xuY29uc3QgcGFja2FnZURlcGVuZGVuY3lQYXR0ZXJuTWF0Y2ggPSAnKiovQHBhY2thZ2UqLyoqLyonLCAvLyBgQHBhY2thZ2UvLi4uYCBgQHBhY2thZ2UteC8uLi5gXG4gIG5vZGVNb2R1bGVQYXR0ZXJuTWF0Y2ggPSAnKiovbm9kZV9tb2R1bGVzLyoqLyonXG5cbi8qKlxuICogTWFwcyBhIGtleSB0byBhIGNhbGxiYWNrIHRvIGEgdGFzayBmdW5jdGlvblxuICovXG5cbi8qXG4gICAgICAgIF8gXyAgICAgICAgICAgIF8gICBfX19fICBfICAgICBfICAgICAgXG4gICAgX19ffCAoXykgX19fIF8gX18gfCB8Xy8gX19ffChfKSBfX3wgfCBfX18gXG4gICAvIF9ffCB8IHwvIF8gXFwgJ18gXFx8IF9fXFxfX18gXFx8IHwvIF9gIHwvIF8gXFxcbiAgfCAoX198IHwgfCAgX18vIHwgfCB8IHxfIF9fXykgfCB8IChffCB8ICBfXy9cbiAgIFxcX19ffF98X3xcXF9fX3xffCB8X3xcXF9ffF9fX18vfF98XFxfXyxffFxcX19ffFxuKi9cbmV4cG9ydCBjb25zdCBjbGllbnRTaWRlX2pzcG0gPSAoeyBub2RlLCBjb250ZXh0IH0pID0+IHtcbiAgbGV0IHRhcmdldFByb2plY3RDb25maWcgPSBjb250ZXh0LnRhcmdldFByb2plY3RDb25maWcgfHwgdGhyb3cgbmV3IEVycm9yKGDigKIgQ29udGV4dCBcInRhcmdldFByb2plY3RDb25maWdcIiB2YXJpYWJsZSBpcyByZXF1aXJlZCB0byBydW4gcHJvamVjdCBkZXBlbmRlbnQgdGFza3MuYClcbiAgaW5zdGFsbFBhY2thZ2VVc2luZ0pzcG0oeyBqc3BtUGF0aDogcGF0aC5qb2luKHRhcmdldFByb2plY3RDb25maWcuZGlyZWN0b3J5LnNvdXJjZSwgJy9wYWNrYWdlTWFuYWdlci9saWJyYXJ5LmJyb3dzZXIuanNwbScpIH0pXG59XG5cbmV4cG9ydCBjb25zdCBjbGllbnRTaWRlX3dlYmNvbXBvbmVudFlhcm4gPSAoeyBub2RlLCBjb250ZXh0IH0pID0+IHtcbiAgbGV0IHRhcmdldFByb2plY3RDb25maWcgPSBjb250ZXh0LnRhcmdldFByb2plY3RDb25maWcgfHwgdGhyb3cgbmV3IEVycm9yKGDigKIgQ29udGV4dCBcInRhcmdldFByb2plY3RDb25maWdcIiB2YXJpYWJsZSBpcyByZXF1aXJlZCB0byBydW4gcHJvamVjdCBkZXBlbmRlbnQgdGFza3MuYClcbiAgaW5zdGFsbFBhY2thZ2VVc2luZ1lhcm4oeyB5YXJuUGF0aDogcGF0aC5qb2luKHRhcmdldFByb2plY3RDb25maWcuZGlyZWN0b3J5LnNvdXJjZSwgJy9wYWNrYWdlTWFuYWdlci93ZWJjb21wb25lbnQuYnJvd3Nlci55YXJuLycpIH0pXG59XG5cbmV4cG9ydCBjb25zdCBjbGllbnRTaWRlX2xpYnJhcnlZYXJuID0gKHsgbm9kZSwgY29udGV4dCB9KSA9PiB7XG4gIGxldCB0YXJnZXRQcm9qZWN0Q29uZmlnID0gY29udGV4dC50YXJnZXRQcm9qZWN0Q29uZmlnIHx8IHRocm93IG5ldyBFcnJvcihg4oCiIENvbnRleHQgXCJ0YXJnZXRQcm9qZWN0Q29uZmlnXCIgdmFyaWFibGUgaXMgcmVxdWlyZWQgdG8gcnVuIHByb2plY3QgZGVwZW5kZW50IHRhc2tzLmApXG4gIGluc3RhbGxQYWNrYWdlVXNpbmdZYXJuKHsgeWFyblBhdGg6IHBhdGguam9pbih0YXJnZXRQcm9qZWN0Q29uZmlnLmRpcmVjdG9yeS5zb3VyY2UsICcvcGFja2FnZU1hbmFnZXIvbGlicmFyeS5icm93c2VyLnlhcm4vJykgfSlcbn1cblxuLypcbiAgICAgICAgICAgICAgICAgXyAgIF8gICAgICAgICAgICBfX19fIF8gXyAgICAgICAgICAgIF8gICBfX19fICBfICAgICBfICAgICAgXG4gICAgIF8gX18gICBfXyBffCB8XyhfKV8gICBfX19fXyAvIF9fX3wgKF8pIF9fXyBfIF9fIHwgfF8vIF9fX3woXykgX198IHwgX19fIFxuICAgIHwgJ18gXFwgLyBfYCB8IF9ffCBcXCBcXCAvIC8gXyBcXCB8ICAgfCB8IHwvIF8gXFwgJ18gXFx8IF9fXFxfX18gXFx8IHwvIF9gIHwvIF8gXFxcbiAgICB8IHwgfCB8IChffCB8IHxffCB8XFwgViAvICBfXy8gfF9fX3wgfCB8ICBfXy8gfCB8IHwgfF8gX19fKSB8IHwgKF98IHwgIF9fL1xuICAgIHxffCB8X3xcXF9fLF98XFxfX3xffCBcXF8vIFxcX19ffFxcX19fX3xffF98XFxfX198X3wgfF98XFxfX3xfX19fL3xffFxcX18sX3xcXF9fX3xcbiovXG5leHBvcnQgY29uc3QgbmF0aXZlQ2xpZW50U2lkZV9jb3B5U291cmNlQ29kZSA9IGFzeW5jICh7IG5vZGUsIGNvbnRleHQgfSkgPT4ge1xuICBsZXQgdGFyZ2V0UHJvamVjdENvbmZpZyA9IGNvbnRleHQudGFyZ2V0UHJvamVjdENvbmZpZyB8fCB0aHJvdyBuZXcgRXJyb3IoYOKAoiBDb250ZXh0IFwidGFyZ2V0UHJvamVjdENvbmZpZ1wiIHZhcmlhYmxlIGlzIHJlcXVpcmVkIHRvIHJ1biBwcm9qZWN0IGRlcGVuZGVudCB0YXNrcy5gKVxuICBhd2FpdCBzeW5jaHJvbml6ZUZpbGUucmVjdXJzaXZlbHlTeW5jRmlsZSh7XG4gICAgc291cmNlOiB0YXJnZXRQcm9qZWN0Q29uZmlnLmRpcmVjdG9yeS5jbGllbnRTaWRlLFxuICAgIGRlc3RpbmF0aW9uOiB0YXJnZXRQcm9qZWN0Q29uZmlnLmRpc3RyaWJ1dGlvbi5jbGllbnRTaWRlLm5hdGl2ZSxcbiAgICBjb3B5Q29udGVudE9ubHk6IHRydWUsXG4gIH0pXG59XG5cbmV4cG9ydCBjb25zdCBuYXRpdmVDbGllbnRTaWRlX2pzb24gPSBhc3luYyAoeyBub2RlLCBjb250ZXh0IH0pID0+IHtcbiAgbGV0IHRhcmdldFByb2plY3RDb25maWcgPSBjb250ZXh0LnRhcmdldFByb2plY3RDb25maWcgfHwgdGhyb3cgbmV3IEVycm9yKGDigKIgQ29udGV4dCBcInRhcmdldFByb2plY3RDb25maWdcIiB2YXJpYWJsZSBpcyByZXF1aXJlZCB0byBydW4gcHJvamVjdCBkZXBlbmRlbnQgdGFza3MuYClcbiAgbGV0IGJhc2VQYXRoID0gdGFyZ2V0UHJvamVjdENvbmZpZy5kaXJlY3RvcnkuY2xpZW50U2lkZVxuICBsZXQgZmlsZUFycmF5ID0gYXdhaXQgd2lsZGNhcmRQYXRobmFtZU1hdGNoZXIoJyoqLyouanNvbicsIHsgY3dkOiBiYXNlUGF0aCwgYWJzb2x1dGU6IHRydWUgLyphbHdheXMgcmVjZWl2ZSBhYnNvbHV0ZSBwYXRocyovLCBpZ25vcmU6IHBhY2thZ2VEZXBlbmRlbmN5UGF0dGVybk1hdGNoIH0pXG4gIGlmIChmaWxlQXJyYXkubGVuZ3RoKSBhd2FpdCBwaXBlbGluZShyZWFkRmlsZUFzT2JqZWN0U3RyZWFtKGZpbGVBcnJheSwgeyBiYXNlOiBiYXNlUGF0aCB9KSwgLi4uanNvblBpcGVsaW5lKCksIHdyaXRlRmlsZUZyb21PYmplY3RTdHJlYW0odGFyZ2V0UHJvamVjdENvbmZpZy5kaXN0cmlidXRpb24uY2xpZW50U2lkZS5uYXRpdmUpKVxufVxuXG5leHBvcnQgY29uc3QgbmF0aXZlQ2xpZW50U2lkZV9odG1sID0gYXN5bmMgKHsgbm9kZSwgY29udGV4dCB9KSA9PiB7XG4gIGxldCB0YXJnZXRQcm9qZWN0Q29uZmlnID0gY29udGV4dC50YXJnZXRQcm9qZWN0Q29uZmlnIHx8IHRocm93IG5ldyBFcnJvcihg4oCiIENvbnRleHQgXCJ0YXJnZXRQcm9qZWN0Q29uZmlnXCIgdmFyaWFibGUgaXMgcmVxdWlyZWQgdG8gcnVuIHByb2plY3QgZGVwZW5kZW50IHRhc2tzLmApXG4gIGxldCBiYXNlUGF0aCA9IHRhcmdldFByb2plY3RDb25maWcuZGlyZWN0b3J5LmNsaWVudFNpZGVcbiAgbGV0IGZpbGVBcnJheSA9IGF3YWl0IHdpbGRjYXJkUGF0aG5hbWVNYXRjaGVyKCcqKi8qLmh0bWwnLCB7IGN3ZDogYmFzZVBhdGgsIGFic29sdXRlOiB0cnVlIC8qYWx3YXlzIHJlY2VpdmUgYWJzb2x1dGUgcGF0aHMqLywgaWdub3JlOiBwYWNrYWdlRGVwZW5kZW5jeVBhdHRlcm5NYXRjaCB9KVxuICBpZiAoZmlsZUFycmF5Lmxlbmd0aClcbiAgICBhd2FpdCBwaXBlbGluZShcbiAgICAgIHJlYWRGaWxlQXNPYmplY3RTdHJlYW0oZmlsZUFycmF5LCB7IGJhc2U6IGJhc2VQYXRoIH0pLFxuICAgICAgLi4uaHRtbFBpcGVsaW5lKHsgYmFiZWxDb25maWdGaWxlTmFtZTogJ25hdGl2ZUNsaWVudFNpZGVCdWlsZC5CYWJlbENvbmZpZy5qcycgfSksXG4gICAgICB3cml0ZUZpbGVGcm9tT2JqZWN0U3RyZWFtKHRhcmdldFByb2plY3RDb25maWcuZGlzdHJpYnV0aW9uLmNsaWVudFNpZGUubmF0aXZlKSxcbiAgICApXG59XG5cbmV4cG9ydCBjb25zdCBuYXRpdmVDbGllbnRTaWRlX3N0eWxlc2hlZXQgPSBhc3luYyAoeyBub2RlLCBjb250ZXh0IH0pID0+IHtcbiAgbGV0IHRhcmdldFByb2plY3RDb25maWcgPSBjb250ZXh0LnRhcmdldFByb2plY3RDb25maWcgfHwgdGhyb3cgbmV3IEVycm9yKGDigKIgQ29udGV4dCBcInRhcmdldFByb2plY3RDb25maWdcIiB2YXJpYWJsZSBpcyByZXF1aXJlZCB0byBydW4gcHJvamVjdCBkZXBlbmRlbnQgdGFza3MuYClcbiAgbGV0IGJhc2VQYXRoID0gdGFyZ2V0UHJvamVjdENvbmZpZy5kaXJlY3RvcnkuY2xpZW50U2lkZVxuICBsZXQgZmlsZUFycmF5ID0gYXdhaXQgd2lsZGNhcmRQYXRobmFtZU1hdGNoZXIoJyoqLyouY3NzJywgeyBjd2Q6IGJhc2VQYXRoLCBhYnNvbHV0ZTogdHJ1ZSAvKmFsd2F5cyByZWNlaXZlIGFic29sdXRlIHBhdGhzKi8sIGlnbm9yZTogcGFja2FnZURlcGVuZGVuY3lQYXR0ZXJuTWF0Y2ggfSlcbiAgaWYgKGZpbGVBcnJheS5sZW5ndGgpIGF3YWl0IHBpcGVsaW5lKHJlYWRGaWxlQXNPYmplY3RTdHJlYW0oZmlsZUFycmF5LCB7IGJhc2U6IGJhc2VQYXRoIH0pLCAuLi5zdHlsZXNoZWV0UGlwZWxpbmUoKSwgd3JpdGVGaWxlRnJvbU9iamVjdFN0cmVhbSh0YXJnZXRQcm9qZWN0Q29uZmlnLmRpc3RyaWJ1dGlvbi5jbGllbnRTaWRlLm5hdGl2ZSkpXG59XG5cbmV4cG9ydCBjb25zdCBuYXRpdmVDbGllbnRTaWRlX2phdmFzY3JpcHQgPSBhc3luYyAoeyBub2RlLCBjb250ZXh0IH0pID0+IHtcbiAgbGV0IHRhcmdldFByb2plY3RDb25maWcgPSBjb250ZXh0LnRhcmdldFByb2plY3RDb25maWcgfHwgdGhyb3cgbmV3IEVycm9yKGDigKIgQ29udGV4dCBcInRhcmdldFByb2plY3RDb25maWdcIiB2YXJpYWJsZSBpcyByZXF1aXJlZCB0byBydW4gcHJvamVjdCBkZXBlbmRlbnQgdGFza3MuYClcbiAgbGV0IGJhc2VQYXRoID0gdGFyZ2V0UHJvamVjdENvbmZpZy5kaXJlY3RvcnkuY2xpZW50U2lkZVxuICBsZXQgZmlsZUFycmF5ID0gYXdhaXQgd2lsZGNhcmRQYXRobmFtZU1hdGNoZXIoXG4gICAgW1xuICAgICAgJyoqLyouanMnLFxuICAgICAgLy8gaW5jbHVkZSBjb21wb2VubnQgaW4gc3BlY2lmaWMgY2FzZVxuICAgICAgLy8gcGF0aC5qb2luKHRhcmdldFByb2plY3RDb25maWcuZGlyZWN0b3J5LmNsaWVudFNpZGUsICcvKiovd2ViY29tcG9uZW50L0BwYWNrYWdlL0Bwb2x5bWVyLyoqLyouanMnKSxcbiAgICBdIHw+IGNvbnZlcnRBcnJheVRvTXVsdGlwbGVQYXR0ZXJuR2xvYiwgLy8gYXMgdGhlIGZpcnN0IGFyZ3VtZW50IG11c3QgYmUgYSBzdHJpbmcuXG4gICAge1xuICAgICAgY3dkOiBiYXNlUGF0aCxcbiAgICAgIGFic29sdXRlOiB0cnVlIC8qYWx3YXlzIHJlY2VpdmUgYWJzb2x1dGUgcGF0aHMqLyxcbiAgICAgIGlnbm9yZTogW1xuICAgICAgICBwYWNrYWdlRGVwZW5kZW5jeVBhdHRlcm5NYXRjaCxcbiAgICAgICAgLy8gJy8qKi93ZWJjb21wb25lbnQvQHBhY2thZ2UvQHBvbHltZXIvKiovYm93ZXJfY29tcG9uZW50cy8qKi8qLmpzJywgLy8gcG9seW1lciAzIGNvbnRhaW5zIGEgYm93ZXJfY29tcG9uZW50cyBmb2xkZXIuXG4gICAgICBdLFxuICAgIH0sXG4gIClcbiAgaWYgKGZpbGVBcnJheS5sZW5ndGgpXG4gICAgYXdhaXQgcGlwZWxpbmUoXG4gICAgICByZWFkRmlsZUFzT2JqZWN0U3RyZWFtKGZpbGVBcnJheSwgeyBiYXNlOiBiYXNlUGF0aCB9KSxcbiAgICAgIC4uLnNlcnZlckpTUGlwZWxpbmUoeyBiYWJlbENvbmZpZ0ZpbGVOYW1lOiAnbmF0aXZlQ2xpZW50U2lkZUJ1aWxkLkJhYmVsQ29uZmlnLmpzJywgaW5jbHVkZVNvdXJjZU1hcDogZmFsc2UgfSksXG4gICAgICB3cml0ZUZpbGVGcm9tT2JqZWN0U3RyZWFtKHRhcmdldFByb2plY3RDb25maWcuZGlzdHJpYnV0aW9uLmNsaWVudFNpZGUubmF0aXZlKSxcbiAgICApXG59XG5cbi8qXG4gICAgICAgICAgICAgICAgIF8gICAgICAgIF9fIF8gXyBfICBfX19fIF8gXyAgICAgICAgICAgIF8gICBfX19fICBfICAgICBfICAgICAgXG4gICAgIF8gX18gICBfX18gfCB8XyAgIF8gLyBfKF8pIHwgfC8gX19ffCAoXykgX19fIF8gX18gfCB8Xy8gX19ffChfKSBfX3wgfCBfX18gXG4gICAgfCAnXyBcXCAvIF8gXFx8IHwgfCB8IHwgfF98IHwgfCB8IHwgICB8IHwgfC8gXyBcXCAnXyBcXHwgX19cXF9fXyBcXHwgfC8gX2AgfC8gXyBcXFxuICAgIHwgfF8pIHwgKF8pIHwgfCB8X3wgfCAgX3wgfCB8IHwgfF9fX3wgfCB8ICBfXy8gfCB8IHwgfF8gX19fKSB8IHwgKF98IHwgIF9fL1xuICAgIHwgLl9fLyBcXF9fXy98X3xcXF9fLCB8X3wgfF98X3xffFxcX19fX3xffF98XFxfX198X3wgfF98XFxfX3xfX19fL3xffFxcX18sX3xcXF9fX3xcbiAgICB8X3wgICAgICAgICAgICB8X19fLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiovXG5leHBvcnQgY29uc3QgcG9seWZpbGxDbGllbnRTaWRlX2NvcHlTb3VyY2VDb2RlID0gKHsgbm9kZSwgY29udGV4dCB9KSA9PiB7XG4gIGxldCB0YXJnZXRQcm9qZWN0Q29uZmlnID0gY29udGV4dC50YXJnZXRQcm9qZWN0Q29uZmlnIHx8IHRocm93IG5ldyBFcnJvcihg4oCiIENvbnRleHQgXCJ0YXJnZXRQcm9qZWN0Q29uZmlnXCIgdmFyaWFibGUgaXMgcmVxdWlyZWQgdG8gcnVuIHByb2plY3QgZGVwZW5kZW50IHRhc2tzLmApXG4gIHN5bmNocm9uaXplRmlsZS5yZWN1cnNpdmVseVN5bmNGaWxlKHsgc291cmNlOiB0YXJnZXRQcm9qZWN0Q29uZmlnLmRpcmVjdG9yeS5jbGllbnRTaWRlLCBkZXN0aW5hdGlvbjogdGFyZ2V0UHJvamVjdENvbmZpZy5kaXN0cmlidXRpb24uY2xpZW50U2lkZS5wb2x5ZmlsbCwgY29weUNvbnRlbnRPbmx5OiB0cnVlIH0pXG59XG5cbmV4cG9ydCBjb25zdCBwb2x5ZmlsbENsaWVudFNpZGVfanNvbiA9IGFzeW5jICh7IG5vZGUsIGNvbnRleHQgfSkgPT4ge1xuICBsZXQgdGFyZ2V0UHJvamVjdENvbmZpZyA9IGNvbnRleHQudGFyZ2V0UHJvamVjdENvbmZpZyB8fCB0aHJvdyBuZXcgRXJyb3IoYOKAoiBDb250ZXh0IFwidGFyZ2V0UHJvamVjdENvbmZpZ1wiIHZhcmlhYmxlIGlzIHJlcXVpcmVkIHRvIHJ1biBwcm9qZWN0IGRlcGVuZGVudCB0YXNrcy5gKVxuICBsZXQgYmFzZVBhdGggPSB0YXJnZXRQcm9qZWN0Q29uZmlnLmRpcmVjdG9yeS5jbGllbnRTaWRlXG4gIGxldCBmaWxlQXJyYXkgPSBhd2FpdCB3aWxkY2FyZFBhdGhuYW1lTWF0Y2hlcignKiovKi5qc29uJywgeyBjd2Q6IGJhc2VQYXRoLCBhYnNvbHV0ZTogdHJ1ZSAvKmFsd2F5cyByZWNlaXZlIGFic29sdXRlIHBhdGhzKi8sIGlnbm9yZTogcGFja2FnZURlcGVuZGVuY3lQYXR0ZXJuTWF0Y2ggfSlcbiAgaWYgKGZpbGVBcnJheS5sZW5ndGgpIGF3YWl0IHBpcGVsaW5lKHJlYWRGaWxlQXNPYmplY3RTdHJlYW0oZmlsZUFycmF5LCB7IGJhc2U6IGJhc2VQYXRoIH0pLCAuLi5qc29uUGlwZWxpbmUoKSwgd3JpdGVGaWxlRnJvbU9iamVjdFN0cmVhbSh0YXJnZXRQcm9qZWN0Q29uZmlnLmRpc3RyaWJ1dGlvbi5jbGllbnRTaWRlLnBvbHlmaWxsKSlcbn1cblxuZXhwb3J0IGNvbnN0IHBvbHlmaWxsQ2xpZW50U2lkZV9odG1sID0gYXN5bmMgKHsgbm9kZSwgY29udGV4dCB9KSA9PiB7XG4gIGxldCB0YXJnZXRQcm9qZWN0Q29uZmlnID0gY29udGV4dC50YXJnZXRQcm9qZWN0Q29uZmlnIHx8IHRocm93IG5ldyBFcnJvcihg4oCiIENvbnRleHQgXCJ0YXJnZXRQcm9qZWN0Q29uZmlnXCIgdmFyaWFibGUgaXMgcmVxdWlyZWQgdG8gcnVuIHByb2plY3QgZGVwZW5kZW50IHRhc2tzLmApXG4gIGxldCBiYXNlUGF0aCA9IHRhcmdldFByb2plY3RDb25maWcuZGlyZWN0b3J5LmNsaWVudFNpZGVcbiAgbGV0IGZpbGVBcnJheSA9IGF3YWl0IHdpbGRjYXJkUGF0aG5hbWVNYXRjaGVyKCcqKi8qLmh0bWwnLCB7IGN3ZDogYmFzZVBhdGgsIGFic29sdXRlOiB0cnVlIC8qYWx3YXlzIHJlY2VpdmUgYWJzb2x1dGUgcGF0aHMqLywgaWdub3JlOiBwYWNrYWdlRGVwZW5kZW5jeVBhdHRlcm5NYXRjaCB9KVxuICBpZiAoZmlsZUFycmF5Lmxlbmd0aClcbiAgICBhd2FpdCBwaXBlbGluZShcbiAgICAgIHJlYWRGaWxlQXNPYmplY3RTdHJlYW0oZmlsZUFycmF5LCB7IGJhc2U6IGJhc2VQYXRoIH0pLFxuICAgICAgLi4uaHRtbFBpcGVsaW5lKHsgYmFiZWxDb25maWdGaWxlTmFtZTogJ3BvbHlmaWxsQ2xpZW50U2lkZUJ1aWxkLkJhYmVsQ29uZmlnLmpzJyB9KSxcbiAgICAgIHdyaXRlRmlsZUZyb21PYmplY3RTdHJlYW0odGFyZ2V0UHJvamVjdENvbmZpZy5kaXN0cmlidXRpb24uY2xpZW50U2lkZS5wb2x5ZmlsbCksXG4gICAgKVxufVxuXG5leHBvcnQgY29uc3QgcG9seWZpbGxDbGllbnRTaWRlX3N0eWxlc2hlZXQgPSBhc3luYyAoeyBub2RlLCBjb250ZXh0IH0pID0+IHtcbiAgbGV0IHRhcmdldFByb2plY3RDb25maWcgPSBjb250ZXh0LnRhcmdldFByb2plY3RDb25maWcgfHwgdGhyb3cgbmV3IEVycm9yKGDigKIgQ29udGV4dCBcInRhcmdldFByb2plY3RDb25maWdcIiB2YXJpYWJsZSBpcyByZXF1aXJlZCB0byBydW4gcHJvamVjdCBkZXBlbmRlbnQgdGFza3MuYClcbiAgbGV0IGJhc2VQYXRoID0gdGFyZ2V0UHJvamVjdENvbmZpZy5kaXJlY3RvcnkuY2xpZW50U2lkZVxuICBsZXQgZmlsZUFycmF5ID0gYXdhaXQgd2lsZGNhcmRQYXRobmFtZU1hdGNoZXIoJyoqLyouY3NzJywgeyBjd2Q6IGJhc2VQYXRoLCBhYnNvbHV0ZTogdHJ1ZSAvKmFsd2F5cyByZWNlaXZlIGFic29sdXRlIHBhdGhzKi8sIGlnbm9yZTogcGFja2FnZURlcGVuZGVuY3lQYXR0ZXJuTWF0Y2ggfSlcbiAgaWYgKGZpbGVBcnJheS5sZW5ndGgpIGF3YWl0IHBpcGVsaW5lKHJlYWRGaWxlQXNPYmplY3RTdHJlYW0oZmlsZUFycmF5LCB7IGJhc2U6IGJhc2VQYXRoIH0pLCAuLi5zdHlsZXNoZWV0UGlwZWxpbmUoKSwgd3JpdGVGaWxlRnJvbU9iamVjdFN0cmVhbSh0YXJnZXRQcm9qZWN0Q29uZmlnLmRpc3RyaWJ1dGlvbi5jbGllbnRTaWRlLnBvbHlmaWxsKSlcbn1cblxuZXhwb3J0IGNvbnN0IHBvbHlmaWxsQ2xpZW50U2lkZV9qYXZhc2NyaXB0ID0gYXN5bmMgKHsgbm9kZSwgY29udGV4dCB9KSA9PiB7XG4gIGxldCB0YXJnZXRQcm9qZWN0Q29uZmlnID0gY29udGV4dC50YXJnZXRQcm9qZWN0Q29uZmlnIHx8IHRocm93IG5ldyBFcnJvcihg4oCiIENvbnRleHQgXCJ0YXJnZXRQcm9qZWN0Q29uZmlnXCIgdmFyaWFibGUgaXMgcmVxdWlyZWQgdG8gcnVuIHByb2plY3QgZGVwZW5kZW50IHRhc2tzLmApXG4gIGxldCBiYXNlUGF0aCA9IHRhcmdldFByb2plY3RDb25maWcuZGlyZWN0b3J5LmNsaWVudFNpZGVcbiAgbGV0IGZpbGVBcnJheSA9IGF3YWl0IHdpbGRjYXJkUGF0aG5hbWVNYXRjaGVyKFxuICAgIFtcbiAgICAgICcqKi8qLmpzJyxcbiAgICAgIC8vIGluY2x1ZGUgY29tcG9lbm50IGluIHNwZWNpZmljIGNhc2VcbiAgICAgIC8vIHBhdGguam9pbih0YXJnZXRQcm9qZWN0Q29uZmlnLmRpcmVjdG9yeS5jbGllbnRTaWRlLCAnLyoqL3dlYmNvbXBvbmVudC9AcGFja2FnZS9AcG9seW1lci8qKi8qLmpzJyksXG4gICAgXSB8PiBjb252ZXJ0QXJyYXlUb011bHRpcGxlUGF0dGVybkdsb2IsXG4gICAge1xuICAgICAgY3dkOiBiYXNlUGF0aCxcbiAgICAgIGFic29sdXRlOiB0cnVlIC8qYWx3YXlzIHJlY2VpdmUgYWJzb2x1dGUgcGF0aHMqLyxcbiAgICAgIGlnbm9yZTogW1xuICAgICAgICBwYWNrYWdlRGVwZW5kZW5jeVBhdHRlcm5NYXRjaCxcbiAgICAgICAgLy8gJy8qKi93ZWJjb21wb25lbnQvQHBhY2thZ2UvQHBvbHltZXIvKiovYm93ZXJfY29tcG9uZW50cy8qKi8qLmpzJywgLy8gcG9seW1lciAzIGNvbnRhaW5zIGEgYm93ZXJfY29tcG9uZW50cyBmb2xkZXIuXG4gICAgICBdLFxuICAgIH0sXG4gIClcbiAgaWYgKGZpbGVBcnJheS5sZW5ndGgpXG4gICAgYXdhaXQgcGlwZWxpbmUoXG4gICAgICByZWFkRmlsZUFzT2JqZWN0U3RyZWFtKGZpbGVBcnJheSwgeyBiYXNlOiBiYXNlUGF0aCB9KSxcbiAgICAgIC4uLnNlcnZlckpTUGlwZWxpbmUoeyBiYWJlbENvbmZpZ0ZpbGVOYW1lOiAncG9seWZpbGxDbGllbnRTaWRlQnVpbGQuQmFiZWxDb25maWcuanMnLCBpbmNsdWRlU291cmNlTWFwOiBmYWxzZSB9KSxcbiAgICAgIHdyaXRlRmlsZUZyb21PYmplY3RTdHJlYW0odGFyZ2V0UHJvamVjdENvbmZpZy5kaXN0cmlidXRpb24uY2xpZW50U2lkZS5wb2x5ZmlsbCksXG4gICAgKVxufVxuXG4vKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fX18gIF8gICAgIF8gICAgICBcbiAgICAgX19fICBfX18gXyBfX19fICAgX19fX18gXyBfXy8gX19ffChfKSBfX3wgfCBfX18gXG4gICAgLyBfX3wvIF8gXFwgJ19fXFwgXFwgLyAvIF8gXFwgJ19fXFxfX18gXFx8IHwvIF9gIHwvIF8gXFxcbiAgICBcXF9fIFxcICBfXy8gfCAgIFxcIFYgLyAgX18vIHwgICBfX18pIHwgfCAoX3wgfCAgX18vXG4gICAgfF9fXy9cXF9fX3xffCAgICBcXF8vIFxcX19ffF98ICB8X19fXy98X3xcXF9fLF98XFxfX198XG4qL1xuZXhwb3J0IGNvbnN0IHNlcnZlclNpZGVfaW5zdGFsbFBhY2thZ2VVc2luZ1lhcm4gPSAoeyBub2RlLCBjb250ZXh0IH0pID0+IHtcbiAgbGV0IHRhcmdldFByb2plY3RDb25maWcgPSBjb250ZXh0LnRhcmdldFByb2plY3RDb25maWcgfHwgdGhyb3cgbmV3IEVycm9yKGDigKIgQ29udGV4dCBcInRhcmdldFByb2plY3RDb25maWdcIiB2YXJpYWJsZSBpcyByZXF1aXJlZCB0byBydW4gcHJvamVjdCBkZXBlbmRlbnQgdGFza3MuYClcbiAgaW5zdGFsbFBhY2thZ2VVc2luZ1lhcm4oeyB5YXJuUGF0aDogcGF0aC5qb2luKHRhcmdldFByb2plY3RDb25maWcuZGlyZWN0b3J5LnNvdXJjZSwgJy9wYWNrYWdlTWFuYWdlci9saWJyYXJ5LnNlcnZlci55YXJuLycpIH0pXG59XG5cbmV4cG9ydCBjb25zdCBzZXJ2ZXJTaWRlX2NvcHlTZXJ2ZXJTaWRlID0gYXN5bmMgKHsgbm9kZSwgY29udGV4dCB9KSA9PiB7XG4gIGxldCB0YXJnZXRQcm9qZWN0Q29uZmlnID0gY29udGV4dC50YXJnZXRQcm9qZWN0Q29uZmlnIHx8IHRocm93IG5ldyBFcnJvcihg4oCiIENvbnRleHQgXCJ0YXJnZXRQcm9qZWN0Q29uZmlnXCIgdmFyaWFibGUgaXMgcmVxdWlyZWQgdG8gcnVuIHByb2plY3QgZGVwZW5kZW50IHRhc2tzLmApXG4gIGF3YWl0IHN5bmNocm9uaXplRmlsZS5yZWN1cnNpdmVseVN5bmNGaWxlKHsgc291cmNlOiB0YXJnZXRQcm9qZWN0Q29uZmlnLmRpcmVjdG9yeS5zZXJ2ZXJTaWRlLCBkZXN0aW5hdGlvbjogdGFyZ2V0UHJvamVjdENvbmZpZy5kaXN0cmlidXRpb24uc2VydmVyU2lkZSwgY29weUNvbnRlbnRPbmx5OiB0cnVlIH0pXG59XG5cbmV4cG9ydCBjb25zdCBzZXJ2ZXJTaWRlX2NvcHlEYXRhYmFzZURhdGEgPSBhc3luYyAoeyBub2RlLCBjb250ZXh0IH0pID0+IHtcbiAgbGV0IHRhcmdldFByb2plY3RDb25maWcgPSBjb250ZXh0LnRhcmdldFByb2plY3RDb25maWcgfHwgdGhyb3cgbmV3IEVycm9yKGDigKIgQ29udGV4dCBcInRhcmdldFByb2plY3RDb25maWdcIiB2YXJpYWJsZSBpcyByZXF1aXJlZCB0byBydW4gcHJvamVjdCBkZXBlbmRlbnQgdGFza3MuYClcbiAgYXdhaXQgc3luY2hyb25pemVGaWxlLnJlY3Vyc2l2ZWx5U3luY0ZpbGUucmVjdXJzaXZlbHlTeW5jRmlsZSh7XG4gICAgc291cmNlOiBwYXRoLmpvaW4odGFyZ2V0UHJvamVjdENvbmZpZy5kaXJlY3Rvcnkuc291cmNlLCAnZGF0YWJhc2VEYXRhJyksXG4gICAgZGVzdGluYXRpb246IHRhcmdldFByb2plY3RDb25maWcuZGlyZWN0b3J5LmRpc3RyaWJ1dGlvbixcbiAgICBjb3B5Q29udGVudE9ubHk6IGZhbHNlLFxuICB9KVxufVxuXG5leHBvcnQgY29uc3Qgc2VydmVyU2lkZV90cmFuc3BpbGVEYXRhYmFzZURhdGEgPSBhc3luYyAoeyBub2RlLCBjb250ZXh0IH0pID0+IHtcbiAgbGV0IHRhcmdldFByb2plY3RDb25maWcgPSBjb250ZXh0LnRhcmdldFByb2plY3RDb25maWcgfHwgdGhyb3cgbmV3IEVycm9yKGDigKIgQ29udGV4dCBcInRhcmdldFByb2plY3RDb25maWdcIiB2YXJpYWJsZSBpcyByZXF1aXJlZCB0byBydW4gcHJvamVjdCBkZXBlbmRlbnQgdGFza3MuYClcbiAgbGV0IGJhc2VQYXRoID0gdGFyZ2V0UHJvamVjdENvbmZpZy5kaXJlY3Rvcnkuc291cmNlXG4gIGxldCBmaWxlQXJyYXkgPSBhd2FpdCB3aWxkY2FyZFBhdGhuYW1lTWF0Y2hlcignZGF0YWJhc2VEYXRhLyoqLyouanMnLCB7IGN3ZDogYmFzZVBhdGgsIGFic29sdXRlOiB0cnVlIC8qYWx3YXlzIHJlY2VpdmUgYWJzb2x1dGUgcGF0aHMqLywgaWdub3JlOiBub2RlTW9kdWxlUGF0dGVybk1hdGNoIH0pXG4gIGlmIChmaWxlQXJyYXkubGVuZ3RoKVxuICAgIGF3YWl0IHBpcGVsaW5lKFxuICAgICAgcmVhZEZpbGVBc09iamVjdFN0cmVhbShmaWxlQXJyYXksIHsgYmFzZTogYmFzZVBhdGggfSksXG4gICAgICAuLi5zZXJ2ZXJKU1BpcGVsaW5lKHsgYmFiZWxDb25maWdGaWxlTmFtZTogJ3NlcnZlckJ1aWxkLkJhYmVsQ29uZmlnLmpzJywgaW5jbHVkZVNvdXJjZU1hcDogZmFsc2UgfSksXG4gICAgICB3cml0ZUZpbGVGcm9tT2JqZWN0U3RyZWFtKHBhdGguam9pbih0YXJnZXRQcm9qZWN0Q29uZmlnLmRpcmVjdG9yeS5kaXN0cmlidXRpb24sICdkYXRhYmFzZURhdGEvJykpLFxuICAgIClcbn1cblxuZXhwb3J0IGNvbnN0IHNlcnZlclNpZGVfdHJhbnNwaWxlU2VydmVyU2lkZSA9IGFzeW5jICh7IG5vZGUsIGNvbnRleHQgfSkgPT4ge1xuICBsZXQgdGFyZ2V0UHJvamVjdENvbmZpZyA9IGNvbnRleHQudGFyZ2V0UHJvamVjdENvbmZpZyB8fCB0aHJvdyBuZXcgRXJyb3IoYOKAoiBDb250ZXh0IFwidGFyZ2V0UHJvamVjdENvbmZpZ1wiIHZhcmlhYmxlIGlzIHJlcXVpcmVkIHRvIHJ1biBwcm9qZWN0IGRlcGVuZGVudCB0YXNrcy5gKVxuICBsZXQgYmFzZVBhdGggPSB0YXJnZXRQcm9qZWN0Q29uZmlnLmRpcmVjdG9yeS5zZXJ2ZXJTaWRlXG4gIGxldCBmaWxlQXJyYXkgPSBhd2FpdCB3aWxkY2FyZFBhdGhuYW1lTWF0Y2hlcignKiovKi5qcycsIHsgY3dkOiBiYXNlUGF0aCwgYWJzb2x1dGU6IHRydWUgLyphbHdheXMgcmVjZWl2ZSBhYnNvbHV0ZSBwYXRocyovLCBpZ25vcmU6IG5vZGVNb2R1bGVQYXR0ZXJuTWF0Y2ggfSlcbiAgaWYgKGZpbGVBcnJheS5sZW5ndGgpXG4gICAgYXdhaXQgcGlwZWxpbmUoXG4gICAgICByZWFkRmlsZUFzT2JqZWN0U3RyZWFtKGZpbGVBcnJheSwgeyBiYXNlOiBiYXNlUGF0aCB9KSxcbiAgICAgIC4uLnNlcnZlckpTUGlwZWxpbmUoeyBiYWJlbENvbmZpZ0ZpbGVOYW1lOiAnc2VydmVyQnVpbGQuQmFiZWxDb25maWcuanMnLCBpbmNsdWRlU291cmNlTWFwOiBmYWxzZSB9KSxcbiAgICAgIHdyaXRlRmlsZUZyb21PYmplY3RTdHJlYW0odGFyZ2V0UHJvamVjdENvbmZpZy5kaXN0cmlidXRpb24uc2VydmVyU2lkZSksXG4gICAgKVxufVxuIl19